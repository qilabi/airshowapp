 @{
    ViewBag.Title = "订单列表";
     
} 
    <!DOCTYPE HTML>
    <html ng-app="qibilaApp">
    <head>
        <title>订单列表</title>
        <link href="http://cdn.bootcss.com/ionic/1.3.2/css/ionic.min.css" rel="stylesheet">
        <link href="~/assets/orderList.css" rel="stylesheet" />

    </head>
    <body class="stable-bg">
    <div class="bar bar-header bar-positive item item-icon-right">
        @*<i class="icon ion-location"></i>*@
        <h1 class="title">订单列表</h1>
        <button class="button icon ion-refresh"></button>
    </div>
    <div id="main" ng-controller="orderController">
        <div class="orders scroll-content has-header">
            <div class="list clearfix">
                @{ var list = (IEnumerable<Senparc.Weixin.MP.Sample.CommonService.Domain.Models.AirOrder>) ViewData["orders"];}
                @foreach (var order in list)
                {
                    <div class="item item-icon-right clearfix">
                        <div>
                            <div class="title-lips">@order.Title（11.4-11.6）</div>
                            <div class="item-detail">数量：@order.TicketCount 张</div>
                            <div class="item-detail">电话号码：@order.Telephone</div>
                            @{string statusString = "未支付";}
                            <span class="status">
                                @if (order.Status.Equals(0))
                                {
                                    statusString = "未支付";
                                }
                                else if (order.Status.Equals(1))
                                {
                                    statusString = "待出票";
                                }
                                else if (order.Status.Equals(3))
                                {
                                    statusString = "已出票";
                                }@statusString<br><em class="money">¥@order.Amount</em>
                                        </span>
                            <a href="#" ng-click="showOrderDetail(this,'@Url.Action("OrderDetailLines", new {orderNo = order.OrderNo})')" data-href="@Url.Action("OrderDetailLines", new {orderNo = order.OrderNo})">
                                <input type="hidden" name="orderNo" ng-model="orders.orderNo" value="@order.OrderNo"/>
                                <i class="icon ion-ios-arrow-right">
                                </i>
                            </a>
                        </div>
                        <div ng-if="identityInfos.length>0">
                            <ul class="list" ng-repeat="identityInfo in identityInfos">
                                <li class="item">
                                    <div class="title-lips">
                                        用户名:{{identityInfo.RealName}}
                                        <br/>
                                        身份证:{{identityInfo.IdentityCardNo}}
                                        <br/>
                                        单价:{{identityInfo.UnitPrice}}
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                }
                @if (list.Count() == 0)
                {
                    <div class="item item-icon-right clearfix">
                        <h1 style="text-align: center;">当前没有订单</h1>
                    </div>
                }
            </div>
        </div>
    </div>

    @Html.Partial("_BottomNav")
    <script src="http://cdn.bootcss.com/angular.js/1.4.14/angular.min.js"></script>
    <script>
        var ftitAppModule = angular.module('qibilaApp', []);

        ftitAppModule.controller('orderController', function ($scope, $log) {
            $scope.identityInfos = new Array();
            $scope.showOrderDetail = function($scope,link) {
                $.ajax({
                    url: link,
                    async: false,
                    dataType:'json',
                    success:function(resp) {
                     if (resp.Success && resp.List) {
                         $scope.identityInfos = resp.List;
                     }
                    }
                });
            };
        });
    </script>
    </body>
</html>

